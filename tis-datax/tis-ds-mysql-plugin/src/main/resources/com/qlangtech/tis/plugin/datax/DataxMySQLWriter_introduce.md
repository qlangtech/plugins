## 插件简介

DataX MySQL写入器是TIS数据同步平台中专门用于将数据写入MySQL数据库的核心插件。它基于阿里巴巴开源的DataX框架,为用户提供了高效、可靠的MySQL数据写入能力。该插件支持MySQL 5.x和MySQL 8.x两个主流版本,提供了灵活的写入模式选择和自动建表功能,极大简化了数据同步的配置工作。

## 核心作用

- **多种写入模式**:支持insert、replace和ON DUPLICATE KEY UPDATE三种写入模式,满足不同业务场景需求。insert适用于新数据插入,replace可在主键冲突时替换旧记录,ON DUPLICATE KEY UPDATE则允许冲突时更新指定字段。

- **自动建表功能**:支持在目标MySQL数据库中自动创建表结构,根据源端表的元数据自动生成DDL并执行,特别适合数据迁移和新环境搭建场景。

- **灵活的SQL控制**:支持配置前置SQL和后置SQL,在数据写入前后执行自定义SQL语句,可用于数据清理、索引管理、统计信息更新等场景。

- **批量写入优化**:支持批量提交数据,通过batchSize参数控制每批次提交的记录数,提高写入效率。

## 适用场景

- **数据仓库加载**:将经过清洗转换的数据批量加载到MySQL数据库,构建数据集市或报表库。

- **系统间数据同步**:在异构系统环境中,将来自其他数据库的数据同步到MySQL,实现数据共享和集成。

- **数据库迁移**:进行数据库平台迁移时,将其他数据库的数据迁移到MySQL,或在MySQL版本升级时实现数据平滑迁移。

- **实时数据写入**:配合增量数据采集插件,实时接收变更数据并写入MySQL目标库。

## 工作机制

插件在数据同步任务中扮演目标端角色。任务启动时,首先建立与目标MySQL数据库的JDBC连接。如果配置了前置SQL会先执行准备工作,如清空目标表或调整参数。启用自动建表功能时,插件会检查目标表是否存在,不存在则自动创建。

数据写入阶段,插件根据配置的写入模式使用相应的SQL语句批量写入数据。为提高效率,支持通过batchSize参数控制批量提交。写入完成后,如配置了后置SQL会执行收尾工作,如更新统计信息或重建索引。

插件内置校验机制,会检查目标数据源是否配置了分表策略,因为写入端不支持分表数据源,确保数据准确写入单一目标表。

## 使用建议

- **写入模式选择**:全量初始化场景使用insert或replace模式,增量更新场景使用ON DUPLICATE KEY UPDATE模式。

- **批量大小调优**:根据记录大小和网络状况,建议将batchSize设置在1000到10000之间。

- **避免分表数据源**:确保目标数据源未配置分表策略,否则插件会在校验阶段报错。
