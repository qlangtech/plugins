<?xml version="1.0" encoding="UTF-8"?>

<!--~
  ~   Licensed to the Apache Software Foundation (ASF) under one
  ~   or more contributor license agreements.  See the NOTICE file
  ~   distributed with this work for additional information
  ~   regarding copyright ownership.  The ASF licenses this file
  ~   to you under the Apache License, Version 2.0 (the
  ~   "License"); you may not use this file except in compliance
  ~   with the License.  You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~   Unless required by applicable law or agreed to in writing, software
  ~   distributed under the License is distributed on an "AS IS" BASIS,
  ~   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~   See the License for the specific language governing permissions and
  ~   limitations under the License.
  -->

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.qlangtech.tis</groupId>
        <artifactId>tis</artifactId>
        <version>3.7.2</version>
    </parent>
    <groupId>com.qlangtech.tis.plugins</groupId>
    <artifactId>tis-plugin-parent</artifactId>
    <packaging>pom</packaging>
    <version>3.7.2</version>
    <name>TIS Plugin Parent POM</name>
    <description>The TIS Plugins Parent POM Project</description>
    <inceptionYear>2020</inceptionYear>

    <scm>
        <connection>scm:git:git://github.com/qlangtech/plugins.git</connection>
        <developerConnection>scm:git:ssh://git@github.com/qlangtech/plugins.git</developerConnection>
        <url>https://github.com/qlangtech/plugins/tree/master</url>
        <tag>HEAD</tag>
    </scm>

    <modules>
        <!--        <module>tis-spark-hive-server-extends</module>-->
        <!--        <module>tis-hdfs-plugin</module>-->
        <module>tis-scala-compiler-dependencies</module>
        <module>tis-datax</module>
        <module>tis-incr</module>

        <module>tis-asyncmsg-rocketmq-plugin</module>

        <module>tis-k8s-plugin</module>
        <module>tis-aliyun-fs-plugin</module>
        <module>tis-plugin-test/customer-plugin-test</module>


        <!--        <module>tis-kafka-plugin</module>-->

        <module>tis-plugin-test/tis-testcontainer-mysql</module>
        <module>tis-plugin-test/tis-testcontainer-postgresql</module>
        <module>tis-plugin-test/tis-testcontainer-oracle</module>
        <module>tis-plugin-test/tis-testcontainer-starrocks</module>
        <module>tis-e2e</module>

        <!--        <module>tis-solr-plugin</module>
                <module>tis-local-dump-build</module>-->
    </modules>
    <profiles>
        <profile>
            <!--https://emr-next.console.aliyun.com/#/resource/all/create/ecs-->
            <id>aliyun-emr</id>
            <properties>
                <spark2.version>3.2.1</spark2.version>
                <hadoop-version>3.2.1</hadoop-version>
                <spark.dist.dir.name>spark-${spark2.version}-bin-hadoop3.2</spark.dist.dir.name>
                <!--                <hudi.version>0.12.2</hudi.version>-->
                <!--                <hive.version>3.1.3</hive.version>-->

                <hudi.version>0.10.1</hudi.version>
                <hive.version>3.1.2</hive.version>

                <scala.binary.version>2.12</scala.binary.version>
                <scala.version>2.12.9</scala.version>
                <appname>all</appname>
            </properties>
            <modules>

            </modules>
        </profile>
    </profiles>

    <properties>
        <zeppelin.version>0.10.2-SNAPSHOT</zeppelin.version>


        <scala.version>2.11.12</scala.version>
        <scala.binary.version>2.11</scala.binary.version>
        <spark2.version>2.4.4</spark2.version>
        <hudi.version>0.10.1</hudi.version>
        <!--        <revision>2.3.0</revision>-->
        <spark.dist.dir.name>spark-${spark2.version}-bin-hadoop2.7</spark.dist.dir.name>
        <hadoop-version>2.7.3</hadoop-version>
        <hive.version>2.3.1</hive.version>

        <maven-tpi-plugin.classpathDependentExcludes>
            com.alibaba:fastjson,org.apache.commons:commons-lang3,commons-logging:commons-logging,commons-lang:commons-lang,com.google.guava:guava,log4j:log4j,org.slf4j:*,ch.qos.logback:*,org.apache.logging.log4j:*
        </maven-tpi-plugin.classpathDependentExcludes>
        <maven-tpi-plugin.version>${project.version}</maven-tpi-plugin.version>
        <tis.version>${project.version}</tis.version>

        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <project.build.outputEncoding>UTF-8</project.build.outputEncoding>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <releaseProfiles></releaseProfiles>
        <arguments></arguments>
        <argLine>-Xms768M -Xmx768M -Djava.awt.headless=true -XX:+HeapDumpOnOutOfMemoryError -XX:+TieredCompilation
            -XX:TieredStopAtLevel=1
        </argLine>


        <stapler-plugin.version>1.17</stapler-plugin.version>
        <java.level>8</java.level>
        <!-- Change this property if you need your tests to be compiled with a different Java level than the plugin. -->
        <!-- Use only if strictly necessary. It may cause problems in your IDE. -->
        <java.level.test>${java.level}</java.level.test>

        <!-- Defines a SpotBugs threshold. Use "Low" to discover low-priority bugs.
             Hint: SpotBugs considers some real NPE risks in Jenkins as low-priority issues, it is recommended to enable it in plugins.
          -->
        <spotbugs.threshold>Medium</spotbugs.threshold>
        <!-- Defines a SpotBugs effort. Use "Max" to maximize the scan depth -->
        <spotbugs.effort>Default</spotbugs.effort>

        <!-- Whether to skip tests during release phase (they are executed in the prepare phase). -->
        <release.skipTests>true</release.skipTests>
        <!-- By default we do not create *-tests.jar. Set to false to allow other plugins to depend on test utilities in yours, using <classifier>tests</classifier>. -->
        <no-test-jar>true</no-test-jar>

        <node.version>4.0.0</node.version>
        <npm.version>2.13.1</npm.version>
        <yarn.version>0.23.0</yarn.version>
        <frontend-version>1.9.1</frontend-version>
        <skip.node.tests/> <!-- changed by -DskipTests, if specified - see profile -->
        <skip.node.lint/> <!-- changed by -DskipLint, if specified - see profile -->
        <npm.loglevel/> <!-- may use e.g. -\-silent (without backslash) -->

        <!-- To skip the wizard by default in hpi:run. It should not impact other goals. -->
        <hudson.Main.development>true</hudson.Main.development>

        <access-modifier.version>1.16</access-modifier.version>
        <!-- May be used to select timestamped snapshots: -->
        <access-modifier-annotation.version>${access-modifier.version}</access-modifier-annotation.version>
        <access-modifier-checker.version>${access-modifier.version}</access-modifier-checker.version>
        <animal.sniffer.version>1.18</animal.sniffer.version>
        <powermock.version>2.0.7</powermock.version>

        <!-- To opt in to @Restricted(Beta.class) APIs, set to true: -->
        <useBeta>false</useBeta>
        <scmTag>HEAD</scmTag>
        <!-- Where to put temporary files during test runs. -->
        <surefireTempDir>${project.build.directory}/tmp</surefireTempDir>
    </properties>


    <dependencyManagement>
        <dependencies>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-testcontainer-oracle</artifactId>
                <version>${project.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-testcontainer-starrocks</artifactId>
                <version>${project.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-scala-compiler</artifactId>
                <version>${project.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>commons-dbcp</groupId>
                        <artifactId>commons-dbcp</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.qlangtech.tis</groupId>
                        <artifactId>tis-common</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.qlangtech.tis</groupId>
                        <artifactId>ibator</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-datax-test-common</artifactId>
                <scope>test</scope>
                <version>${project.version}</version>
            </dependency>

            <dependency>
                <groupId>org.easymock</groupId>
                <artifactId>easymock</artifactId>
                <version>4.2</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>org.apache.hive</groupId>
                <artifactId>hive-jdbc</artifactId>
                <version>${hive.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>log4j</groupId>
                        <artifactId>apache-log4j-extras</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.eclipse.jetty.aggregate</groupId>
                        <artifactId>jetty-all</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>commons-logging</groupId>
                        <artifactId>commons-logging</artifactId>
                    </exclusion>
                    <exclusion>
                        <artifactId>
                            hadoop-yarn-server-resourcemanager
                        </artifactId>
                        <groupId>org.apache.hadoop</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>zookeeper</artifactId>
                        <groupId>org.apache.zookeeper</groupId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.derby</groupId>
                        <artifactId>derby</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.glassfish.web</groupId>
                        <artifactId>javax.servlet.jsp</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>


            <dependency>
                <groupId>org.apache.hive</groupId>
                <artifactId>hive-exec</artifactId>
                <version>${hive.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>asm</groupId>
                        <artifactId>asm</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.hive</groupId>
                        <artifactId>hive-ant</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.pentaho</groupId>
                        <artifactId>pentaho-aggdesigner-algorithm</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.calcite</groupId>
                        <artifactId>calcite-avatica</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.calcite.avatica</groupId>
                        <artifactId>avatica</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>tis-sql-parser</artifactId>
                <version>${tis.version}</version>
                <scope>provided</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>tis-builder-api</artifactId>
                <version>${tis.version}</version>
                <scope>provided</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>tis-plugin</artifactId>
                <version>${tis.version}</version>
                <scope>provided</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>datax-config</artifactId>
                <version>${project.version}</version>
                <scope>provided</scope>
            </dependency>


            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.13</version>
            </dependency>
            <!-- JTN tidy this up? -->
            <dependency> <!-- used in JTH and jenkins core > 2.x -->
                <groupId>javax.servlet</groupId>
                <artifactId>javax.servlet-api</artifactId>
                <version>3.1.0</version>
            </dependency>
            <dependency>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>animal-sniffer-annotations</artifactId>
                <version>${animal.sniffer.version}</version>
            </dependency>
            <!--
            <dependency>
                <groupId>org.codehaus.mojo.signature</groupId>
                <artifactId>java18</artifactId>
                <version>1.0</version>
                <type>signature</type>
            </dependency>
            -->
            <dependency>
                <groupId>org.mockito</groupId>
                <artifactId>mockito-core</artifactId>
                <version>3.3.3</version>
            </dependency>
            <dependency>
                <groupId>org.powermock</groupId>
                <artifactId>powermock-module-junit4</artifactId>
                <version>${powermock.version}</version>
            </dependency>
            <dependency>
                <groupId>org.powermock</groupId>
                <artifactId>powermock-api-mockito2</artifactId>
                <version>${powermock.version}</version>
            </dependency>
            <dependency>
                <groupId>org.objenesis</groupId>
                <artifactId>objenesis</artifactId>
                <version>3.1</version>
            </dependency>

            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-hdfs</artifactId>
                <version>${hadoop-version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>tomcat</groupId>
                        <artifactId>jasper-runtime</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>io.netty</groupId>
                        <artifactId>netty</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>xml-apis</groupId>
                        <artifactId>xml-apis</artifactId>
                    </exclusion>
                    <!--                <exclusion>-->
                    <!--                    <groupId>xerces</groupId>-->
                    <!--                    <artifactId>xercesImpl</artifactId>-->
                    <!--                </exclusion>-->
                </exclusions>
            </dependency>

            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-mapreduce-client-core</artifactId>
                <version>${hadoop-version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>jdk.tools</groupId>
                        <artifactId>jdk.tools</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-log4j12</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>
            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-yarn-client</artifactId>
                <version>${hadoop-version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>log4j</groupId>
                        <artifactId>log4j</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-core</artifactId>
                <version>${hadoop-version}</version>
            </dependency>

            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-common</artifactId>
                <version>${hadoop-version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>org.apache.httpcomponents</groupId>
                        <artifactId>httpclient</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.sun.jersey</groupId>
                        <artifactId>jersey-server</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>javax.servlet</groupId>
                        <artifactId>servlet-api</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.mortbay.jetty</groupId>
                        <artifactId>jetty</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.mortbay.jetty</groupId>
                        <artifactId>jetty-util</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.sun.jersey</groupId>
                        <artifactId>jersey-core</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.sun.jersey</groupId>
                        <artifactId>jersey-json</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>om.sun.jersey</groupId>
                        <artifactId>jersey-server</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>tomcat</groupId>
                        <artifactId>jasper-compiler</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>tomcat</groupId>
                        <artifactId>jasper-runtime</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>javax.servlet.jsp</groupId>
                        <artifactId>jsp-api</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>net.java.dev.jets3t</groupId>
                        <artifactId>jets3t</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-log4j12</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.curator</groupId>
                        <artifactId>curator-client</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.curator</groupId>
                        <artifactId>curator-recipes</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>org.apache.hadoop</groupId>
                <artifactId>hadoop-client</artifactId>
                <version>${hadoop-version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>xerces</groupId>
                        <artifactId>xercesImpl</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.hadoop</groupId>
                        <artifactId>hadoop-mapreduce-client-core</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.commons</groupId>
                        <artifactId>commons-math3</artifactId>
                    </exclusion>

                    <exclusion>
                        <groupId>org.mortbay.jetty</groupId>
                        <artifactId>jsp-api-2.1</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.mortbay.jetty</groupId>
                        <artifactId>jsp</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>tomcat</groupId>
                        <artifactId>jasper-runtime</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>tomcat</groupId>
                        <artifactId>jasper-compiler</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.hadoop</groupId>
                        <artifactId>hadoop-mapreduce-client-app</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.hadoop</groupId>
                        <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.apache.hadoop</groupId>
                        <artifactId>hadoop-yarn-server-nodemanager</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>tis-base-test</artifactId>
                <version>${tis.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-datax-mongodb-plugin</artifactId>
                <version>${project.version}</version>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-datax-doris-plugin</artifactId>
                <version>${project.version}</version>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-datax-starrocks-plugin</artifactId>
                <version>${project.version}</version>
            </dependency>

            <dependency>
                <groupId>com.qlangtech.tis.plugins</groupId>
                <artifactId>tis-k8s-plugin</artifactId>
                <version>${project.version}</version>
            </dependency>

        </dependencies>
    </dependencyManagement>

    <dependencies>


        <!--
                <dependency>
                    <groupId>com.qlangtech.tis</groupId>
                    <artifactId>tis-builder-api</artifactId>
                </dependency>
        -->

        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>com.qlangtech.tis</groupId>
            <artifactId>tis-plugin</artifactId>
        </dependency>


        <!-- dependencies provided by virtue of running in Jenkins -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <scope>provided</scope>
        </dependency>

        <!-- static analysis
        <dependency>
            <groupId>com.github.spotbugs</groupId>
            <artifactId>spotbugs-annotations</artifactId>
            <scope>provided</scope>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>net.jcip</groupId>
            <artifactId>jcip-annotations</artifactId>
            <scope>provided</scope>
            <optional>true</optional>
        </dependency>-->

        <!-- for JRE requirement check annotation -->
        <dependency>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>animal-sniffer-annotations</artifactId>
            <scope>provided</scope>
            <optional>true</optional><!-- no need to have this at runtime -->
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <!--
          Since new versions need to overwrite old versions, it's better
          not to have version number in the .hpi file name.
        -->
        <finalName>${project.artifactId}</finalName>
        <pluginManagement>
            <plugins>
                <plugin>
                    <artifactId>maven-antrun-plugin</artifactId>
                    <version>3.0.0</version>
                </plugin>
                <plugin>
                    <artifactId>maven-clean-plugin</artifactId>
                    <version>3.1.0</version>
                </plugin>
                <plugin>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>3.8.1</version>
                </plugin>
                <plugin>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <version>3.1.2</version>
                </plugin>
                <plugin>
                    <artifactId>maven-jar-plugin</artifactId>
                    <version>3.2.0</version>
                </plugin>
                <plugin>
                    <artifactId>maven-resources-plugin</artifactId>
                    <version>3.1.0</version>
                </plugin>
                <!--                <plugin>-->
                <!--                    <artifactId>maven-surefire-plugin</artifactId>-->
                <!--                    <version>3.0.0-M4</version>-->
                <!--                </plugin>-->
                <plugin>
                    <artifactId>maven-failsafe-plugin</artifactId>
                    <version>3.0.0-M4</version>
                </plugin>
                <plugin>
                    <artifactId>maven-deploy-plugin</artifactId>
                    <version>2.8.2
                    </version> <!-- TODO >3.0.0-M1 when MDEPLOY-244 is fixed (likely to cause security release issues without) -->
                </plugin>
                <plugin>
                    <artifactId>maven-enforcer-plugin</artifactId>
                    <version>3.0.0-M3</version> <!-- TODO 3.0.0 when released -->
                </plugin>
                <plugin>
                    <artifactId>maven-install-plugin</artifactId>
                    <version>3.0.0-M1</version>
                </plugin>
                <plugin>
                    <artifactId>maven-javadoc-plugin</artifactId>
                    <version>3.2.0</version>
                    <configuration>
                        <source>${java.level}</source>
                        <quiet>true</quiet>
                        <links>
                            <link>https://javadoc.jenkins.io/</link>
                        </links>
                    </configuration>
                </plugin>
                <plugin>
                    <artifactId>maven-release-plugin</artifactId>
                    <version>2.5.3</version>
                </plugin>
                <plugin>
                    <artifactId>maven-site-plugin</artifactId>
                    <version>3.9.0</version>
                </plugin>
                <plugin>
                    <artifactId>maven-project-info-reports-plugin</artifactId>
                    <version>3.0.0</version>
                </plugin>
                <plugin>
                    <artifactId>maven-source-plugin</artifactId>
                    <version>3.2.1</version>
                </plugin>
                <plugin>
                    <artifactId>maven-war-plugin</artifactId>
                    <version>3.2.3</version>
                </plugin>
                <plugin>
                    <artifactId>maven-eclipse-plugin</artifactId>
                    <version>2.10</version>
                    <!--
                      Because Eclipse lacks JSR-269 support, put the output
                      to a different directory
                    -->
                    <configuration>
                        <buildOutputDirectory>target/eclipse-classes</buildOutputDirectory>
                        <additionalProjectnatures>
                            <!-- enable Groovy nature by default for DSLD support  -->
                            <projectnature>org.eclipse.jdt.groovy.core.groovyNature</projectnature>
                        </additionalProjectnatures>
                    </configuration>
                </plugin>
                <!--                <plugin>-->
                <!--                    <groupId>org.codehaus.gmavenplus</groupId>-->
                <!--                    <artifactId>gmavenplus-plugin</artifactId>-->
                <!--                    <version>1.9.0</version>-->
                <!--                </plugin>-->
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>build-helper-maven-plugin</artifactId>
                    <version>3.1.0</version>
                    <executions>
                        <execution>
                            <id>add-source</id>
                            <phase>generate-sources</phase>
                            <goals>
                                <goal>add-source</goal>
                            </goals>
                            <configuration>
                                <sources>
                                    <source>${project.build.directory}/generated-sources/localizer</source>
                                </sources>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.jacoco</groupId>
                    <artifactId>jacoco-maven-plugin</artifactId>
                    <version>0.8.5</version>
                </plugin>
                <plugin>
                    <groupId>org.kohsuke.stapler</groupId>
                    <artifactId>maven-stapler-plugin</artifactId>
                    <version>${stapler-plugin.version}</version>
                </plugin>
                <!--
                <plugin>
                    <groupId>org.jenkins-ci.tools</groupId>
                    <artifactId>maven-hpi-plugin</artifactId>
                    <version>${hpi-plugin.version}</version>
                </plugin>
                -->
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>animal-sniffer-maven-plugin</artifactId>
                    <version>${animal.sniffer.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.jvnet.localizer</groupId>
                    <artifactId>maven-localizer-plugin</artifactId>
                    <version>1.26</version>
                </plugin>
                <plugin>
                    <groupId>org.kohsuke</groupId>
                    <artifactId>access-modifier-checker</artifactId>
                    <version>${access-modifier-checker.version}</version>
                </plugin>
                <plugin>
                    <groupId>com.cloudbees</groupId>
                    <artifactId>maven-license-plugin</artifactId>
                    <version>1.8</version>
                </plugin>
                <plugin> <!-- not gated by Incrementals profiles, since we want the incrementalify goal to be available from the start -->
                    <groupId>io.jenkins.tools.incrementals</groupId>
                    <artifactId>incrementals-maven-plugin</artifactId>
                    <version>1.1</version>
                    <configuration>
                        <includes>
                            <include>org.jenkins-ci.*</include>
                            <include>io.jenkins.*</include>
                        </includes>
                        <generateBackupPoms>false</generateBackupPoms>
                        <updateNonincremental>false</updateNonincremental>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>com.github.spotbugs</groupId>
                    <artifactId>spotbugs-maven-plugin</artifactId>
                    <version>4.0.0</version>
                </plugin>
                <plugin>
                    <groupId>com.qlangtech.tis</groupId>
                    <artifactId>maven-tpi-plugin</artifactId>
                    <version>${maven-tpi-plugin.version}</version>
                    <extensions>true</extensions>
                </plugin>
            </plugins>
        </pluginManagement>
        <plugins>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-deploy-plugin</artifactId>
                <configuration>
                    <skip>true</skip>
                </configuration>
            </plugin>

            <plugin>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>tisasm-maven-plugin</artifactId>
                <configuration>
                    <assembleFileExtension>.tpi</assembleFileExtension>
                    <subDir>tis-plugin</subDir>
                </configuration>
                <executions>
                    <execution>
                        <id>make-deploy</id>
                        <phase>deploy</phase>
                        <goals>
                            <goal>put</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>make-assembly</id>
                        <phase>none</phase>
                    </execution>
                </executions>
            </plugin>

            <plugin>
                <artifactId>maven-jar-plugin</artifactId>
                <executions>
                    <execution>
                        <id>maybe-test-jar</id>
                        <goals>
                            <goal>test-jar</goal>
                        </goals>
                        <configuration>
                            <excludes>
                                <exclude>the.hpl</exclude>
                                <exclude>InjectedTest.class</exclude>
                                <exclude>test-dependencies/</exclude>
                            </excludes>
                            <skip>${no-test-jar}</skip>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <artifactId>maven-enforcer-plugin</artifactId>
                <executions>
                    <execution>
                        <id>display-info</id>
                        <!--                        <phase>validate</phase>-->
                        <phase>none</phase>
                        <goals>
                            <goal>display-info</goal>
                            <goal>enforce</goal>
                        </goals>
                        <configuration>
                            <rules>

                                <requireMavenVersion>
                                    <version>[3.3.1,)</version>
                                    <message>3.3.1 required to at least look at .mvn/ if it exists.</message>
                                </requireMavenVersion>
                                <requireJavaVersion>
                                    <version>[1.8.0,)</version>
                                </requireJavaVersion>
                                <!-- TODO failing during incrementals deploy: MENFORCER-281
                                <requirePluginVersions>
                                  <banSnapshots>false</banSnapshots>
                                </requirePluginVersions>
                                -->

                                <bannedDependencies>
                                    <searchTransitive>true</searchTransitive>
                                    <excludes>
                                        <exclude>javax.servlet:servlet-api</exclude>
                                        <exclude>org.sonatype.sisu:sisu-guice</exclude>
                                        <exclude>log4j:log4j:*:jar:compile</exclude>
                                        <exclude>log4j:log4j:*:jar:runtime</exclude>
                                        <exclude>commons-logging:commons-logging:*:jar:compile</exclude>
                                        <exclude>commons-logging:commons-logging:*:jar:runtime</exclude>
                                        <!-- Jenkins TestAll Harness is based on JUnit. Adding TestNG dependency would disable some of its functionality. -->
                                        <exclude>org.testng:testng</exclude>
                                    </excludes>

                                </bannedDependencies>
                                <requireUpperBoundDeps>
                                    <excludes>
                                        <exclude>commons-codec:commons-codec</exclude>
                                        <exclude>io.netty:netty</exclude>
                                        <exclude>com.google.guava:guava
                                        </exclude> <!-- TODO needed for Jenkins 2.71 and earlier -->
                                        <exclude>commons-logging:commons-logging</exclude> <!-- ditto -->
                                        <exclude>com.google.code.findbugs:jsr305</exclude> <!-- ditto -->
                                        <exclude>net.java.dev.jna:jna
                                        </exclude> <!-- needed for Jenkins 1.585 and earlier -->
                                    </excludes>
                                </requireUpperBoundDeps>
                            </rules>
                            <fail>false</fail>
                        </configuration>
                    </execution>
                    <execution>
                        <id>no-snapshots-in-release</id>
                        <phase>validate</phase>
                        <goals>
                            <goal>enforce</goal>
                        </goals>
                        <configuration>
                            <rules>
                                <!--
                                  this causes fails the incrementals IT to fail as the parent is a snapshot and the incremental is a release
                                  so this is a separate execution so that it can be skipped in that specific IT
                                  -->
                                <requireReleaseDeps>
                                    <message>No SNAPSHOT versions are allowed for releases</message>
                                    <onlyWhenRelease>true</onlyWhenRelease>
                                    <!--  whilst we generally want this this allows for easier testing of the plugin-pom in incrementals -->
                                    <failWhenParentIsSnapshot>false</failWhenParentIsSnapshot>
                                </requireReleaseDeps>
                            </rules>
                            <fail>false</fail>
                        </configuration>
                    </execution>
                </executions>
                <!-- FIXME 暂时去除掉
                https://www.mojohaus.org/extra-enforcer-rules/index.html
                    <dependencies>
                        <dependency>
                            <groupId>org.codehaus.mojo</groupId>
                            <artifactId>extra-enforcer-rules</artifactId>
                            <version>1.2</version>
                        </dependency>
                    </dependencies>
                -->
            </plugin>

            <!--
            <plugin>
                <groupId>com.github.spotbugs</groupId>
                <artifactId>spotbugs-maven-plugin</artifactId>
                <configuration>
                    <failOnError>${spotbugs.failOnError}</failOnError>
                </configuration>
                <executions>
                    <execution>
                        <id>spotbugs</id>
                        <goals>
                            <goal>check</goal>
                        </goals>
                        <phase>verify</phase>
                        <configuration>
                            <xmlOutput>true</xmlOutput>
                            <spotbugsXmlOutput>false</spotbugsXmlOutput>
                            <effort>${spotbugs.effort}</effort>
                            <threshold>${spotbugs.threshold}</threshold>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
-->
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.${java.level}</source>
                    <target>1.${java.level}</target>
                    <testSource>1.${java.level.test}</testSource>
                    <testTarget>1.${java.level.test}</testTarget>
                </configuration>
            </plugin>
            <!--
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>animal-sniffer-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>check</goal>
                        </goals>
                        <id>check</id>
                        <phase>test</phase>
                    </execution>
                </executions>
                <configuration>
                    <signature>
                        <groupId>org.codehaus.mojo.signature</groupId>
                        <artifactId>java1${java.level}</artifactId>
                    </signature>
                </configuration>
            </plugin>
            -->
            <plugin>
                <artifactId>maven-eclipse-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>com.qlangtech.tis</groupId>
                <artifactId>maven-tpi-plugin</artifactId>
                <extensions>true</extensions>
                <configuration>
                    <pluginFirstClassLoader>true</pluginFirstClassLoader>
                    <minimumJavaVersion>1.${java.level}</minimumJavaVersion>
                    <classpathDependentExcludes>${maven-tpi-plugin.classpathDependentExcludes}
                    </classpathDependentExcludes>
                </configuration>
            </plugin>

            <plugin>
                <artifactId>maven-release-plugin</artifactId>
                <configuration>
                    <mavenExecutorId>forked-path</mavenExecutorId>
                    <useReleaseProfile>false</useReleaseProfile>
                    <preparationGoals>clean install</preparationGoals>
                    <goals>deploy</goals>
                    <arguments>${arguments}</arguments>
                    <releaseProfiles>jenkins-release,${releaseProfiles}</releaseProfiles>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.jvnet.localizer</groupId>
                <artifactId>maven-localizer-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>generate</goal>
                        </goals>
                        <configuration>
                            <fileMask>Messages.properties</fileMask>
                            <outputDirectory>target/generated-sources/localizer</outputDirectory>
                            <accessModifierAnnotations>true</accessModifierAnnotations>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <!--
            <plugin>
                <groupId>org.kohsuke</groupId>
                <artifactId>access-modifier-checker</artifactId>
                <configuration>
                    <properties>
                        <property>
                            <name>useBeta</name>
                            <value>${useBeta}</value>
                        </property>
                    </properties>
                </configuration>
            </plugin>
            -->
            <!--            <plugin>-->
            <!--                <groupId>org.codehaus.gmavenplus</groupId>-->
            <!--                <artifactId>gmavenplus-plugin</artifactId>-->
            <!--                <executions>-->
            <!--                    <execution>-->
            <!--                        <id>test-in-groovy</id>-->
            <!--                        <goals>-->
            <!--                            <goal>addTestSources</goal>-->
            <!--                            <goal>generateTestStubs</goal>-->
            <!--                            <goal>compileTests</goal>-->
            <!--                        </goals>-->
            <!--                    </execution>-->
            <!--                </executions>-->
            <!--                <configuration>-->
            <!--                    &lt;!&ndash; gmavenplus generates into generated-sources/test by default. gmaven generated into this directory. &ndash;&gt;-->
            <!--                    <testStubsOutputDirectory>${project.build.directory}/generated-test-sources/groovy-stubs-->
            <!--                    </testStubsOutputDirectory>-->
            <!--                </configuration>-->

            <!--            </plugin>-->
            <plugin> <!-- https://stackoverflow.com/a/4086207/12916 -->
                <artifactId>maven-antrun-plugin</artifactId>
                <executions>
                    <execution>
                        <id>createTempDir</id>
                        <phase>generate-test-resources</phase>
                        <configuration>
                            <target>
                                <mkdir dir="${surefireTempDir}"/>
                            </target>
                        </configuration>
                        <goals>
                            <goal>run</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <!--            <plugin>-->
            <!--                <artifactId>maven-surefire-plugin</artifactId>-->
            <!--                <configuration>-->
            <!--                    &lt;!&ndash; SUREFIRE-1226 workaround &ndash;&gt;-->
            <!--                    <trimStackTrace>false</trimStackTrace>-->
            <!--                    <systemProperties>-->
            <!--                        <property>-->
            <!--                            <name>hudson.udp</name>-->
            <!--                            <value>-1</value>-->
            <!--                        </property>-->
            <!--                        <property>-->
            <!--                            <name>java.io.tmpdir</name>-->
            <!--                            <value>${surefireTempDir}</value>-->
            <!--                        </property>-->
            <!--                    </systemProperties>-->
            <!--                    <runOrder>alphabetical</runOrder>-->
            <!--                </configuration>-->
            <!--            </plugin>-->

            <plugin>
                <groupId>com.cloudbees</groupId>
                <artifactId>maven-license-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>process</goal>
                        </goals>
                        <phase>prepare-package</phase>
                        <configuration>
                            <!--requireCompleteLicenseInfo>true</requireCompleteLicenseInfo-->
                            <generateLicenseXml>target/${project.artifactId}/WEB-INF/licenses.xml</generateLicenseXml>
                            <inlineScript><![CDATA[
                filter {
                    def plugins = [] as Set

                    // collect all Jenkins plugins
                    models.entrySet().each { e ->
                        if (e.value.packaging=="hpi")
                            plugins.add(e.key.id)
                    }

                    // filter out dependencies that don't belong to this plugin
                    models.entrySet().removeAll(models.entrySet().findAll { e ->
                        def a = e.key;

                        if (a.dependencyTrail.size()>0 && plugins.contains(a.dependencyTrail[1]))
                            return true; // ignore transitive dependencies through other plugins

                        // if the dependency goes through jenkins core, we don't need to bundle it in the war
                        // because jenkins-core comes in the <provided> scope, I think this is a bug in Maven that it puts such
                        // dependencies into the artifact list.
                        if (a.dependencyTrail.find { trail -> trail.contains(":hudson-core:") || trail.contains(":jenkins-core:") })
                            return true;

                        return false;
                    })
                }
              ]]></inlineScript>
                        </configuration>
                    </execution>
                </executions>
            </plugin>

            <!--  the following 2 plugins are for integration tests of plugin-pom only -->
            <!--
             <plugin>
                 <groupId>org.codehaus.mojo</groupId>
                 <artifactId>mrm-maven-plugin</artifactId>
                 <version>1.2.0</version>
                 <inherited>false</inherited>
                 <executions>
                     <execution>
                         <goals>
                             <goal>start</goal>
                             <goal>stop</goal>
                         </goals>
                         <configuration>
                             <propertyName>repository.proxy.url</propertyName>
                             <repositories>
                                 <proxyRepo/>
                             </repositories>
                         </configuration>
                     </execution>
                 </executions>
             </plugin>
             -->
            <!--
              <plugin>
                  <artifactId>maven-invoker-plugin</artifactId>
                  <version>3.2.1</version>
                  <inherited>false</inherited>
                  <executions>
                      <execution>
                          <id>integration-test</id>
                          <goals>
                              <goal>install</goal>
                              <goal>run</goal>
                          </goals>
                          <configuration>
                              <streamLogs>true</streamLogs>
                              <showErrors>true</showErrors>
                              <cloneProjectsTo>${project.build.directory}/its</cloneProjectsTo>
                              <localRepositoryPath>${basedir}/target/local-repo</localRepositoryPath>
                              <settingsFile>src/it/settings.xml</settingsFile>
                              <filterProperties>
                                  <repository.proxy.url>${repository.proxy.url}</repository.proxy.url>
                              </filterProperties>
                          </configuration>
                      </execution>
                  </executions>
              </plugin>
              -->
        </plugins>
    </build>

    <!--
    <repositories>
        <repository>
            <id>repo.jenkins-ci.org</id>
            <url>https://repo.jenkins-ci.org/public/</url>
        </repository>
    </repositories>

    <pluginRepositories>
        <pluginRepository>
            <id>repo.jenkins-ci.org</id>
            <url>https://repo.jenkins-ci.org/public/</url>
        </pluginRepository>
    </pluginRepositories>

    <distributionManagement>
        <repository>
            <uniqueVersion>false</uniqueVersion>
            <id>maven.jenkins-ci.org</id>
            <url>https://repo.jenkins-ci.org/releases/</url>
        </repository>
        <snapshotRepository>
            <id>maven.jenkins-ci.org</id>
            <url>https://repo.jenkins-ci.org/snapshots/</url>
        </snapshotRepository>
    </distributionManagement>
-->
</project>
